    For giving rank of each contious series
    np.array(a.groupby(['vin',(a['partial_charge'] != a['partial_charge'].shift()).cumsum()]).cumcount()+1)
    
    import itertools
    def expandgrid(*itrs):
        product = list(itertools.product(*itrs))
        return {'Var{}'.format(i+1):[x[i] for x in product] for i in range(len(itrs))}
    
    a=[1,2,4]
    b=['a','b']
    c=['c','d']
    pd.DataFrame(expandgrid(a,b,c))
