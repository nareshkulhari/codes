np.array(a.groupby(['vin',(a['partial_charge'] != 1).cumsum()]).cumcount()+1)
